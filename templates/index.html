{% extends "base.html" %}
{% block content %}

<section class="painel-tarefas">
<form method="GET" class="caixa-busca">
        <input type="text" name="q" placeholder="Pesquisar cuidados ou animais..." value="{{ q }}">
        <select name="priority">
            <option value="">Todas</option>
            <option value="Baixa">Baixa</option>
            <option value="Média">Média</option>
            <option value="Alta">Alta</option>
        </select>
        <button type="submit">Filtrar</button>
    </form>

    <div class="grade-tarefas">
        {% for t in tasks %}
        <article class="cartao-tarefa {% if t.done %}concluido{% endif %}">
            <header class="cabecalho-cartao">
                <span class="distintivo">{{ t.priority }}</span>
                <span class="texto-status">{{ "Concluída" if t.done else "Pendente" }}</span>
            </header>

            {% set image_filename = t.image or "task.png" %}
            <div class="corpo-cartao">
                <img src="{{ url_for('static', filename='img/' + image_filename) }}" alt="Ícone da tarefa">
                <div>
                    <h3>{{ t.title }}</h3>
                    <p>Rotina dedicada aos cuidados, estoque ou agendamentos do pet shop.</p>
                </div>
            </div>

            <div class="acoes-cartao">
                <form action="{{ url_for('tasks.toggle', id=t.id) }}" method="POST">
                    <button type="submit" class="botao primario">Marcar como feita</button>
                </form>

                <a class="botao transparente" href="{{ url_for('tasks.edit', id=t.id) }}">Editar</a>

                <form action="{{ url_for('tasks.delete', id=t.id) }}" method="POST">
                    <button type="submit" class="botao perigoso">Excluir</button>
                </form>
            </div>
        </article>
        {% endfor %}
    </div>
</section>

{% endblock %}
